!function(p){"use strict";botiga.mstepc={customerDetailsFields:[{title:botiga_mstepc.i18n.customer_details_phone,field_id:"billing_phone"},{title:botiga_mstepc.i18n.customer_details_email,field_id:"billing_email"}],billingDetailsFields:[{title:botiga_mstepc.i18n.billing_details_name,field_id:"billing_first_name"},{title:botiga_mstepc.i18n.billing_details_last_name,field_id:"billing_last_name"},{title:botiga_mstepc.i18n.billing_details_company,field_id:"billing_company"},{title:botiga_mstepc.i18n.billing_details_address_1,field_id:"billing_address_1"},{title:botiga_mstepc.i18n.billing_details_address_2,field_id:"billing_address_2"},{title:botiga_mstepc.i18n.billing_details_city,field_id:"billing_city"},{title:botiga_mstepc.i18n.billing_details_state,field_id:"billing_state"},{title:botiga_mstepc.i18n.billing_details_postcode,field_id:"billing_postcode"},{title:botiga_mstepc.i18n.billing_details_country,field_id:"billing_country"}],shippingDetailsFields:[{title:botiga_mstepc.i18n.shipping_details_name,field_id:"shipping_first_name"},{title:botiga_mstepc.i18n.shipping_details_last_name,field_id:"shipping_last_name"},{title:botiga_mstepc.i18n.shipping_details_company,field_id:"shipping_company"},{title:botiga_mstepc.i18n.shipping_details_address_1,field_id:"shipping_address_1"},{title:botiga_mstepc.i18n.shipping_details_address_2,field_id:"shipping_address_2"},{title:botiga_mstepc.i18n.shipping_details_city,field_id:"shipping_city"},{title:botiga_mstepc.i18n.shipping_details_state,field_id:"shipping_state"},{title:botiga_mstepc.i18n.shipping_details_postcode,field_id:"shipping_postcode"},{title:botiga_mstepc.i18n.shipping_details_country,field_id:"shipping_country"}],init:function(){var i=this;return this.initialized=!1,setTimeout(function(){p(".botiga-mstepc-tabs-nav-item:first-child > a").trigger("click"),p("form.checkout .required, form.woocommerce-form-login .required").each(function(){p(this).closest(".form-row").find("input").attr("required",!0),p(this).closest(".form-row").find("select").attr("required",!0)}),i.initialized=!0},1e3),this.events(),this},events:function(){var c=this;return p(document).on("updated_checkout",function(){p(".woocommerce-checkout-payment input").each(function(){p(this).attr("required",!0)})}),p(document).on("checkout_error",function(){p(".botiga-mstepc-place-order").removeClass("loading disabled")}),p(".botiga-mstepc-tabs-nav-item > a").on("click",function(i){i.preventDefault();var t,e=p(this).data("step"),s=p(this).data("validate-selector").split(","),o=p(this).data("content-selector").split(","),a=p(".botiga-mstepc-tabs-nav-item"),l=p(this).parent(),n=p(this).parent().prev(),r=n.find("> a").data("step"),d=p(this).parent().next(),i=d.find("> a").data("step");if(setTimeout(function(){p("form.woocommerce-checkout .woocommerce-input-wrapper .error:not(label), .woocommerce-form__input-checkbox[required].error").each(function(){return p("html").animate({scrollTop:p(this).offset().top-200},100),p(this).focus(),!1})},500),c.validateBeforeNext(s)||n.hasClass("no-validation"))p(this).parent().prev().addClass("completed");else if(0===p('.botiga-mstepc-tabs-nav-item > a[data-step="billiing-shipping"]').parent().index)return!1;if(!p(this).parent().prev().hasClass("completed")&&0!==p(this).parent().index())return!1;c.showNextStep(o),a.removeClass("previous-step current-step next-step"),l.addClass("current-step"),n.addClass("previous-step"),d.addClass("next-step"),p(".botiga-mstepc-wrapper").removeClass("login billing-shipping order-payment order-review").addClass(e),!0===c.initialized&&(p(".botiga-mstepc-wrapper .woocommerce-error").remove(),p(".botiga-mstepc-wrapper .woocommerce-message").remove()),p(".botiga-mstep-order-review .botiga-mstep-order-review__table").html(""),"order-review"===e&&(d=p(".botiga-mstep-order-review"),(e=p(".woocommerce-checkout-review-order-table").clone()).find(".woocommerce-remove-coupon").length&&e.find(".woocommerce-remove-coupon").remove(),e.find(".woocommerce-shipping-methods .shipping_method").each(function(){(p(this).is(":checked")?p(this):p(this).parent()).remove()}),d.find(".botiga-mstep-order-review__table").html(e[0].outerHTML),t='<ul class="botiga-mstep-order-review__customer-details-list">',c.customerDetailsFields.forEach(function(i){var e=p("#"+i.field_id).val();e&&(t+="<li>"+i.title+": "+e+"</li>")}),t+="</div>",d.find(".botiga-mstep-order-review__customer-details").html(t),t='<ul class="botiga-mstep-order-review__address-billing-details-list">',c.billingDetailsFields.forEach(function(i){var e=p("#"+i.field_id).val();e&&(t+="<li>"+i.title+": "+e+"</li>")}),t+="</div>",d.find(".botiga-mstep-order-review__address-billing").html(t),p("#ship-to-different-address-checkbox").is(":checked")?(p(".botiga-mstep-order-review__address-shipping-title").css("display","block"),t='<ul class="botiga-mstep-order-review__address-shipping-details-list">',c.shippingDetailsFields.forEach(function(i){var e=p("#"+i.field_id).val();e&&(t+="<li>"+i.title+": "+e+"</li>")}),t+="</div>",d.find(".botiga-mstep-order-review__address-shipping").html(t)):(p(".botiga-mstep-order-review__address-shipping-title").css("display","none"),p(".botiga-mstep-order-review__address-shipping-details-list").length&&p(".botiga-mstep-order-review__address-shipping-details-list").remove())),p(".botiga-mstepc-next").data("to",i),p(".botiga-mstepc-prev").data("to",r)}),p(".botiga-mstepc-skip-login").on("click",function(i){i.preventDefault(),p(".botiga-mstepc-next").trigger("click")}),p(".botiga-mstepc-next").on("click",function(i){i.preventDefault();var e=p(this).data("to");p("html").animate({scrollTop:0},300,function(){setTimeout(function(){p('.botiga-mstepc-tabs-nav-item > a[data-step="'+e+'"]').trigger("click"),p(window).trigger("botiga.mstepc.next")},600)})}),p(".botiga-mstepc-prev").on("click",function(i){i.preventDefault();var e=p(this).data("to");p("html").animate({scrollTop:0},300,function(){setTimeout(function(){p('.botiga-mstepc-tabs-nav-item > a[data-step="'+e+'"]').trigger("click"),p(window).trigger("botiga.mstepc.prev")},600)})}),p(".botiga-mstepc-place-order").on("click",function(i){i.preventDefault(),p("#place_order").trigger("click"),p(this).addClass("loading disabled")}),this},validateBeforeNext:function(i){var t=!1;return i.forEach(function(i,e){p(i).is("form")&&(t=p(i).valid())}),t},showNextStep:function(i){p(".woocommerce-form-coupon-toggle,.woocommerce-form-login,form.woocommerce-checkout #customer_details,.checkout-wrapper,.woocommerce-form-coupon").removeClass("show showEffect"),i.forEach(function(i,e){p(i).addClass("show"),setTimeout(function(){p(i).addClass("showEffect")},300)})}},p(document).ready(function(){botiga.mstepc.init()})}(jQuery);